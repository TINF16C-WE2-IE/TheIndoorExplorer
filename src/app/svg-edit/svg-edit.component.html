<svg id="editorCanvas" viewBox="0 0 500 500"
     (mouseup)="mouse.onMouseUp($event)" (mousedown)="mouse.onMouseDown($event)"
     (mousemove)="mouse.onMouseMove($event)" (mouseleave)="mouse.onMouseLeave($event)"
     xmlns:svg="http://www.w3.org/2000/svg" version="1.2">

    <svg:g *ngIf="floor">
        <svg:defs>
            <svg:marker id="circle" markerWidth="10" markerHeight="10" refX="5" refY="5" markerUnits="userSpaceOnUse">
                <svg:circle cx="5" cy="5" r="4" style="stroke: none; fill:#000000;"/>
            </svg:marker>
        </svg:defs>

        <svg:line *ngFor="let wall of floor.walls" stroke="black"
                  [attr.x1]="wall.p1.x" [attr.y1]="wall.p1.y" [attr.x2]="wall.p2.x" [attr.y2]="wall.p2.y"
                  marker-end="url(#circle)" marker-start="url(#circle)"/>
        <svg:line *ngFor="let portal of floor.portals" stroke="green" stroke-width="5"
                  [attr.x1]="portal.p1.x" [attr.y1]="portal.p1.y" [attr.x2]="portal.p2.x" [attr.y2]="portal.p2.y"
                  marker-end="url(#circle)" marker-start="url(#circle)"/>

        <svg:circle *ngIf="mouse.xs !== null && mouse.ys !== null"
                    [attr.cx]="mouse.xs" [attr.cy]="mouse.ys" r="5" style="stroke:red; fill:none"/>
    </svg:g>

    <text *ngIf="!floor" x="50%" y="50%" alignment-baseline="middle" text-anchor="middle" font-size="40">
        Bitte warten...
    </text>

</svg>

<form #toolbox id="toolbox">
    <h3>Toolbox</h3>
    <fieldset>
        <legend>Tools</legend>
        <button class="toolbutton" [style.background-color]="mouse.tool.name=='Move Point' ? 'cyan' : ''"
                (click)="selectMoveTool()">Move
        </button>
        <button class="toolbutton" [style.background-color]="mouse.tool.name=='Draw Wall' ? 'cyan' : ''"
                (click)="selectWallDrawTool()">Wall
        </button>
        <button class="toolbutton" [style.background-color]="mouse.tool.name=='Draw Portal' ? 'cyan' : ''"
                (click)="selectPortalDrawTool()">Portal
        </button>
    </fieldset>
    <fieldset>
        <legend>Actions</legend>
        <button class="actionbutton" (click)="saveCurrentMap()">Save</button>
    </fieldset>
    <p>Selected: {{mouse.tool.name}} ({{mouse.x}} | {{mouse.y}})</p>
    <p>
        Stats:
        {{floor?.walls.length || 0}} Walls,
        {{floor?.portals.length || 0}} Portals,
        {{floor?.getAllPoints().length || 0}} Points
    </p>
    <!--<pre>{{this?.floor | json}}</pre>-->
</form>

